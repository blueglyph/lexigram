mod lexiparser {
    // -------------------------------------------------------------------------
    // [lexiparser]

    use rlexer::{grammar::{FactorId, ProdFactor, Symbol, VarId}, parser::{OpCode, Parser}, symbol_table::SymbolTable};

    const PARSER_NUM_T: usize = 27;
    const PARSER_NUM_NT: usize = 22;
    const SYMBOLS_T: [(&str, Option<&str>); PARSER_NUM_T] = [("Arrow", Some("->")), ("Colon", Some(":")), ("Comma", Some(",")), ("Ellipsis", Some("..")), ("Lbracket", Some("{")), ("Lparen", Some("(")), ("Negate", Some("~")), ("Plus", Some("+")), ("Or", Some("|")), ("Question", Some("?")), ("Rbracket", Some("}")), ("Rparen", Some(")")), ("Semicolon", Some(";")), ("Star", Some("*")), ("Channels", Some("channels")), ("Fragment", Some("fragment")), ("Lexicon", Some("lexicon")), ("Mode", Some("mode")), ("Pop", Some("pop")), ("Push", Some("push")), ("Return", Some("return")), ("Skip", Some("skip")), ("SymEof", Some("EOF")), ("Id", None), ("CharLit", None), ("CharSet", None), ("StrLit", None)];
    const SYMBOLS_NT: [&str; PARSER_NUM_NT] = ["file", "header", "declaration", "option", "rule", "actions", "action", "match", "alt_items", "alt_item", "repeat_item", "item", "file_1", "option_1", "actions_1", "alt_item_1", "alt_items_1", "repeat_item_1", "rule_1", "alt_item_2", "repeat_item_2", "repeat_item_3"];
    const SYMBOLS_NAMES: [(&str, VarId); 10] = [("actions_1", 14), ("alt_item_1", 15), ("alt_item_2", 19), ("alt_items_1", 16), ("file_1", 12), ("option_1", 13), ("repeat_item_1", 17), ("repeat_item_2", 20), ("repeat_item_3", 21), ("rule_1", 18)];
    const PARSING_FACTORS: [(VarId, &[Symbol]); 38] = [(0, &[Symbol::NT(1), Symbol::NT(12)]), (0, &[Symbol::NT(12)]), (1, &[Symbol::T(16), Symbol::T(23), Symbol::T(12)]), (2, &[Symbol::T(17), Symbol::T(23), Symbol::T(12)]), (3, &[Symbol::T(14), Symbol::T(4), Symbol::T(23), Symbol::NT(13), Symbol::T(10)]), (4, &[Symbol::T(15), Symbol::T(23), Symbol::T(1), Symbol::NT(7), Symbol::T(12)]), (4, &[Symbol::T(23), Symbol::T(1), Symbol::NT(7), Symbol::NT(18)]), (5, &[Symbol::NT(6), Symbol::NT(14)]), (6, &[Symbol::T(19), Symbol::T(5), Symbol::T(23), Symbol::T(11)]), (6, &[Symbol::T(18)]), (6, &[Symbol::T(21)]), (6, &[Symbol::T(20)]), (7, &[Symbol::NT(8)]), (8, &[Symbol::NT(9), Symbol::NT(16)]), (9, &[Symbol::NT(15)]), (10, &[Symbol::NT(11), Symbol::NT(17)]), (12, &[Symbol::NT(3), Symbol::NT(12)]), (12, &[Symbol::NT(2), Symbol::NT(12)]), (12, &[Symbol::NT(4), Symbol::NT(12)]), (12, &[Symbol::Empty]), (13, &[Symbol::T(2), Symbol::T(23), Symbol::NT(13)]), (13, &[Symbol::Empty]), (14, &[Symbol::T(2), Symbol::NT(6), Symbol::NT(14)]), (14, &[Symbol::Empty]), (15, &[Symbol::NT(10), Symbol::NT(19)]), (16, &[Symbol::T(8), Symbol::NT(9), Symbol::NT(16)]), (16, &[Symbol::Empty]), (17, &[Symbol::T(7), Symbol::NT(20)]), (17, &[Symbol::T(13), Symbol::NT(21)]), (17, &[Symbol::Empty]), (18, &[Symbol::T(0), Symbol::NT(5), Symbol::T(12)]), (18, &[Symbol::T(12)]), (19, &[Symbol::NT(15)]), (19, &[Symbol::Empty]), (20, &[Symbol::T(9), Symbol::NT(17)]), (20, &[Symbol::NT(17)]), (21, &[Symbol::T(9), Symbol::NT(17)]), (21, &[Symbol::NT(17)])];
    const PARSING_TABLE: [FactorId; 550] = [38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 1, 1, 0, 1, 38, 38, 38, 38, 38, 1, 1, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 2, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 3, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 4, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 5, 38, 38, 38, 38, 38, 38, 38, 6, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 7, 7, 7, 7, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 9, 8, 11, 10, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 16, 18, 38, 17, 38, 38, 38, 38, 38, 18, 19, 38, 38, 20, 38, 38, 38, 38, 38, 38, 38, 21, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 22, 38, 38, 38, 38, 38, 38, 38, 38, 38, 23, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 26, 38, 38, 38, 38, 38, 38, 38, 25, 38, 38, 38, 26, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 29, 38, 38, 38, 38, 38, 38, 27, 29, 38, 38, 38, 29, 28, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 30, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 31, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 33, 38, 38, 38, 38, 38, 38, 38, 33, 38, 38, 38, 33, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 35, 38, 38, 38, 38, 38, 38, 35, 35, 34, 38, 38, 35, 35, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 37, 38, 38, 38, 38, 38, 38, 37, 37, 36, 38, 38, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38];
    const FLAGS: [u32; 22] = [2048, 0, 0, 2048, 32, 2048, 0, 0, 512, 6144, 512, 0, 1, 1, 1, 4129, 4, 36, 64, 64, 64, 64];
    const PARENT: [Option<VarId>; 22] = [None, None, None, None, None, None, None, None, None, None, None, None, Some(0), Some(3), Some(5), Some(9), Some(8), Some(10), Some(4), Some(15), Some(17), Some(17)];
    const OPCODES: [&[OpCode]; 38] = [&[OpCode::Exit(0), OpCode::NT(12), OpCode::NT(1)], &[OpCode::Exit(1), OpCode::NT(12)], &[OpCode::Exit(2), OpCode::T(12), OpCode::T(23), OpCode::T(16)], &[OpCode::Exit(3), OpCode::T(12), OpCode::T(23), OpCode::T(17)], &[OpCode::Exit(4), OpCode::T(10), OpCode::NT(13), OpCode::T(23), OpCode::T(4), OpCode::T(14)], &[OpCode::Exit(5), OpCode::T(12), OpCode::NT(7), OpCode::T(1), OpCode::T(23), OpCode::T(15)], &[OpCode::NT(18), OpCode::NT(7), OpCode::T(1), OpCode::T(23)], &[OpCode::Exit(7), OpCode::NT(14), OpCode::NT(6)], &[OpCode::Exit(8), OpCode::T(11), OpCode::T(23), OpCode::T(5), OpCode::T(19)], &[OpCode::Exit(9), OpCode::T(18)], &[OpCode::Exit(10), OpCode::T(21)], &[OpCode::Exit(11), OpCode::T(20)], &[OpCode::Exit(12), OpCode::NT(8)], &[OpCode::NT(16), OpCode::Exit(13), OpCode::NT(9)], &[OpCode::Exit(14), OpCode::NT(15)], &[OpCode::NT(17), OpCode::Exit(15), OpCode::NT(11)], &[OpCode::Loop(12), OpCode::Exit(16), OpCode::NT(3)], &[OpCode::Loop(12), OpCode::Exit(17), OpCode::NT(2)], &[OpCode::Loop(12), OpCode::Exit(18), OpCode::NT(4)], &[OpCode::Exit(19)], &[OpCode::Loop(13), OpCode::Exit(20), OpCode::T(23), OpCode::T(2)], &[OpCode::Exit(21)], &[OpCode::Loop(14), OpCode::Exit(22), OpCode::NT(6), OpCode::T(2)], &[OpCode::Exit(23)], &[OpCode::NT(19), OpCode::NT(10)], &[OpCode::Loop(16), OpCode::Exit(25), OpCode::NT(9), OpCode::T(8)], &[OpCode::Exit(26)], &[OpCode::NT(20), OpCode::T(7)], &[OpCode::NT(21), OpCode::T(13)], &[OpCode::Exit(29)], &[OpCode::Exit(30), OpCode::T(12), OpCode::NT(5), OpCode::T(0)], &[OpCode::Exit(31), OpCode::T(12)], &[OpCode::Loop(15), OpCode::Exit(32)], &[OpCode::Exit(33)], &[OpCode::Loop(17), OpCode::Exit(34), OpCode::T(9)], &[OpCode::Loop(17), OpCode::Exit(35)], &[OpCode::Loop(17), OpCode::Exit(36), OpCode::T(9)], &[OpCode::Loop(17), OpCode::Exit(37)]];
    const START_SYMBOL: VarId = 0;

    pub(super) fn build_parser() -> Parser {
        let mut symbol_table = SymbolTable::new();
        symbol_table.extend_terminals(SYMBOLS_T.into_iter().map(|(s, os)| (s.to_string(), os.map(|s| s.to_string()))));
        symbol_table.extend_non_terminals(SYMBOLS_NT.into_iter().map(|s| s.to_string()));
        symbol_table.extend_names(SYMBOLS_NAMES.into_iter().map(|(s, v)| (s.to_string(), v)));
        let factors: Vec<(VarId, ProdFactor)> = PARSING_FACTORS.into_iter().map(|(v, s)| (v, ProdFactor::new(s.to_vec()))).collect();
        let table: Vec<FactorId> = PARSING_TABLE.into();
        let parsing_table = rlexer::grammar::LLParsingTable {
            num_nt: PARSER_NUM_NT,
            num_t: PARSER_NUM_T + 1,
            factors,
            table,
            flags: FLAGS.into(),
            parent: PARENT.into(),
        };
        Parser::new(parsing_table, symbol_table, OPCODES.into_iter().map(|strip| strip.to_vec()).collect(), START_SYMBOL)
    }

    // [lexiparser]
    // -------------------------------------------------------------------------
}

