#![cfg(test)]

mod lexilexer {
    // -------------------------------------------------------------------------
    // [lexilexer]

    use std::collections::HashMap;
    use std::io::Read;
    use rlexer::dfa::{StateId, Terminal};
    use rlexer::lexer::Lexer;
    use rlexer::lexergen::GroupId;
    use rlexer::segments::{Seg, SegMap};

    const NBR_GROUPS: u32 = 51;
    const INITIAL_STATE: StateId = 0;
    const FIRST_END_STATE: StateId = 23;
    const NBR_STATES: StateId = 96;
    const ASCII_TO_GROUP: [GroupId; 128] = [
        39, 39, 39, 39, 39, 39, 39, 39, 39, 29, 50, 39, 39, 50, 39, 39,   // 0-15
        39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39,   // 16-31
        0, 39, 39, 39, 39, 39, 39, 1, 2, 3, 4, 5, 6, 7, 8, 9,   // 32-47
        31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 10, 11, 39, 39, 30, 12,   // 48-63
        39, 35, 35, 35, 35, 14, 49, 38, 38, 38, 38, 38, 38, 38, 38, 40,   // 64-79
        38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 15, 16, 32, 39, 37,   // 80-95
        39, 45, 35, 17, 13, 42, 18, 19, 41, 48, 38, 44, 20, 21, 46, 43,   // 96-111
        22, 38, 23, 24, 33, 34, 38, 36, 47, 38, 38, 25, 26, 27, 28, 39,   // 112-127
    ];
    const UTF8_TO_GROUP: [(char, GroupId); 0] = [];
    const SEG_TO_GROUP: [(Seg, GroupId); 2] = [
        (Seg(128, 55295), 39),
        (Seg(57344, 1114111), 39), ];
    const TERMINAL_TABLE: [Terminal; 73] = [
        Terminal { token: None, channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(5), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(11), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(13), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(7), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(2), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(26), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(1), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(12), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(9), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(4), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(8), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(10), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(6), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(0), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(3), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(14), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(15), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(16), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(17), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(18), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(19), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(20), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(21), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(22), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(24), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(23), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: None, channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: None, channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(25), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(26), channel: 0, push_mode: None, push_state: None, pop: false },
        Terminal { token: Some(27), channel: 0, push_mode: None, push_state: None, pop: false },
    ];
    const STATE_TABLE: [StateId; 4896] = [
        23, 1, 24, 25, 26, 27, 28, 2, 29, 3, 30, 31, 32, 33, 34, 4, 5, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 23, 96, 96, 96, 33, 33, 33, 33, 96, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 23, // state 0
        8, 96, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 96, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 96, // state 1
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 47, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 2
        96, 96, 96, 96, 6, 96, 96, 96, 96, 91, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 3
        14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 96, 14, 14, 94, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 96, // state 4
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 94, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 94, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 5
        6, 6, 6, 6, 7, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, // state 6
        6, 6, 6, 6, 7, 6, 6, 6, 6, 92, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, // state 7
        13, 93, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 96, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 96, // state 8
        96, 8, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 8, 96, 96, 96, 96, 96, 96, 8, 96, 96, 96, 96, 96, 96, 96, 96, 96, 8, 10, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 8, 96, 96, 96, 96, // state 9
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 11, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 10
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 12, 12, 96, 96, 12, 12, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 12, 96, 96, 96, 12, 96, 96, 96, 96, 96, 96, 12, 96, 96, 12, 96, 96, 96, 12, 96, // state 11
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 12, 12, 96, 96, 12, 12, 96, 96, 96, 96, 96, 96, 96, 96, 8, 96, 96, 96, 12, 96, 96, 96, 12, 96, 96, 96, 96, 96, 96, 12, 96, 96, 12, 96, 96, 96, 12, 96, // state 12
        13, 95, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 16, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 96, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 96, // state 13
        14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 96, 14, 14, 94, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 96, // state 14
        96, 14, 96, 96, 96, 96, 96, 14, 96, 96, 96, 96, 96, 4, 96, 14, 14, 96, 96, 96, 96, 96, 96, 14, 96, 96, 96, 96, 96, 96, 96, 96, 14, 14, 21, 96, 4, 96, 96, 96, 96, 96, 96, 96, 96, 96, 14, 96, 96, 96, 96, // state 15
        96, 13, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 13, 96, 96, 96, 96, 96, 96, 13, 96, 96, 96, 96, 96, 96, 96, 96, 96, 13, 22, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 13, 96, 96, 96, 96, // state 16
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 17, 17, 96, 96, 17, 17, 96, 96, 96, 96, 96, 96, 96, 96, 14, 96, 96, 96, 17, 96, 96, 96, 17, 96, 96, 96, 96, 96, 96, 17, 96, 96, 17, 96, 96, 96, 17, 96, // state 17
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 18, 18, 96, 96, 18, 18, 96, 96, 96, 96, 96, 96, 96, 96, 13, 96, 96, 96, 18, 96, 96, 96, 18, 96, 96, 96, 96, 96, 96, 18, 96, 96, 18, 96, 96, 96, 18, 96, // state 18
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 17, 17, 96, 96, 17, 17, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 17, 96, 96, 96, 17, 96, 96, 96, 96, 96, 96, 17, 96, 96, 17, 96, 96, 96, 17, 96, // state 19
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 18, 18, 96, 96, 18, 18, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 18, 96, 96, 96, 18, 96, 96, 96, 96, 96, 96, 18, 96, 96, 18, 96, 96, 96, 18, 96, // state 20
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 19, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 21
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 20, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 22
        23, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 23, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 23, // state 23 <skip>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 24 <end:5>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 25 <end:11>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 26 <end:13>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 27 <end:7>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 28 <end:2>
        96, 96, 96, 96, 96, 96, 96, 96, 48, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 29 <end:26>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 30 <end:1>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 31 <end:12>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 32 <end:9>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 33 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 89, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 34 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 49, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 35 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 56, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 36 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 63, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 37 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 69, 33, 33, 33, 33, 33, 33, 33, 96, // state 38 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 73, 33, 33, 33, 33, 33, 33, 96, // state 39 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 77, 33, 33, 33, 33, 96, 33, 33, 33, 76, 33, 33, 33, 33, 33, 33, 96, // state 40 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 81, 33, 33, 33, 33, 33, 33, 33, 96, // state 41 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 86, 33, 33, 33, 33, 33, 96, // state 42 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 43 <end:4>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 44 <end:8>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 45 <end:10>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 46 <end:6>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 47 <end:0>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 48 <end:3>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 50, 33, 33, 33, 33, 96, // state 49 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 51, 33, 33, 33, 96, // state 50 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 52, 33, 33, 33, 96, // state 51 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 96, // state 52 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 54, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 53 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 55, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 54 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 55 <end:14>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 57, 33, 33, 33, 33, 96, // state 56 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 58, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 57 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 59, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 58 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 60, 33, 33, 33, 33, 33, 33, 33, 96, // state 59 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 61, 33, 33, 33, 96, // state 60 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 62, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 61 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 62 <end:15>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 64, 33, 33, 33, 33, 96, // state 63 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 65, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 64 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 66, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 65 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 67, 33, 33, 33, 33, 96, // state 66 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 68, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 67 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 68 <end:16>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 70, 33, 33, 96, // state 69 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 71, 33, 33, 33, 33, 33, 33, 33, 96, // state 70 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 72, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 71 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 72 <end:17>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 74, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 73 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 75, 33, 33, 33, 33, 33, 33, 33, 96, // state 74 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 75 <end:18>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 78, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 76 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 79, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 77 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 78 <end:19>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 80, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 79 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 80 <end:20>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 82, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 81 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 83, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 82 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 84, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 83 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 85, 33, 33, 33, 96, // state 84 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 85 <end:21>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 87, 33, 96, // state 86 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 88, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 87 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 88 <end:22>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 90, 96, // state 89 <end:24>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 33, 33, 96, 96, 33, 33, 33, 33, 33, 33, 33, 33, 96, 96, 96, 96, 96, 96, 33, 96, 33, 33, 33, 33, 33, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, // state 90 <end:23>
        91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 91, 96, // state 91 <skip>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 92 <skip>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 93 <end:25>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 94 <end:26>
        96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, 96, // state 95 <end:27>
    ];


    pub fn build_lexer<R: Read>() -> Lexer<R> {
        Lexer::new(
            // parameters
            NBR_GROUPS,
            INITIAL_STATE,
            FIRST_END_STATE,
            NBR_STATES,
            // tables
            Box::new(ASCII_TO_GROUP),
            HashMap::<char, GroupId>::from(UTF8_TO_GROUP),
            SegMap::<GroupId>::from_iter(SEG_TO_GROUP),
            Box::new(STATE_TABLE),
            Box::new(TERMINAL_TABLE),
        )
    }

    // [lexilexer]
    // -------------------------------------------------------------------------
}

#[cfg(test)]
mod test {
    use std::io::Cursor;
    use rlexer::dfa::TokenId;
    use rlexer::escape_string;
    use rlexer::io::CharReader;
    use rlexer::regexgen::{LEXICON, LEXICON_TEXT, LEXICON_TOKENS};
    use crate::gen::lexilexer::lexilexer::build_lexer;

    #[test]
    pub fn check_lexer_tokens() {
        const VERBOSE: bool = false;
        let tests: Vec<(i32, Vec<(&str, Vec<u16>, Vec<&str>)>)> = vec![
            (1, vec![
                // no error
                ("-> : , .. { ( ~ + | ? } ) ; * channels fragment grammar lexer mode pop push return skip",
                 vec![0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22],
                 vec!["->", ":", ",", "..", "{", "(", "~", "+", "|", "?", "}", ")", ";", "*",
                      "channels", "fragment", "grammar", "lexer", "mode", "pop", "push", "return", "skip"]),
            ]),
            (2, vec![(LEXICON, LEXICON_TOKENS.to_vec(), LEXICON_TEXT.to_vec())]),
        ];
        let mut lexer = build_lexer();
        for (test_id, inputs) in tests {
            if VERBOSE { println!("test {test_id}:"); }
            for (input, expected_tokens, expected_texts) in inputs {
                //let expected_texts = expected_texts.iter().map(|s| s.escape_default());
                if VERBOSE { print!("\"{}\":", escape_string(input)); }
                let stream = CharReader::new(Cursor::new(input));
                lexer.attach_stream(stream);
                let (tokens, texts): (Vec<TokenId>, Vec<String>) = lexer.tokens().map(|(tok, ch, text)| {
                    assert_eq!(ch, 0, "test {} failed for input {}", test_id, escape_string(input));
                    (tok, text)
                }).unzip();
                let err_msg = format!("test {} failed for input '{}'", test_id, escape_string(input));
                assert_eq!(tokens, expected_tokens, "{err_msg}");
                assert_eq!(texts, expected_texts, "{err_msg}");
                assert!(lexer.get_error() == None || lexer.get_error().unwrap().is_eos, "{err_msg}");
            }
            if VERBOSE { println!("--------------------------------------\n"); }
        }
    }
}